<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Faktura</title>
  <style>
    body {
      background-color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      font-family: Arial, sans-serif;
    }

    /* KROK 1: Kontener na tło
       Ustawiamy wymiary pasujące do Twojego (teraz pionowego) zdjęcia.
       Zakładam proporcje kartki A4 (np. 700x1000px).
    */
    .faktura-kontener {
      position: relative;
      width: 2000px;
      height: 900px;
      background-image: url('faktura.jpg'); /* Upewnij się, że nazwa pliku się zgadza */
      background-size: cover;
      background-repeat: no-repeat;
      border: 1px solid #000;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }

    /* KROK 2: Style dla pól */
    
    /* Wspólny styl dla wszystkich pól na fakturze */
    .pole {
      position: absolute;
      font-size: 20px;
      padding: 5px;
      box-sizing: border-box;
    }
    
    /* Styl dla pól ładowanych z XML (bez ramki) */
    .pole-xml {
      background: transparent;
      border: none;
      font-weight: bold;
      color: #333;
    }

    /* Styl dla pól, w które użytkownik wpisuje dane (lekka ramka) */
    .pole-input {
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(0, 0, 255, 0.4);
    }
    
    /* Styl dla pól obliczonych (wyników) */
    .pole-wynik {
      background: rgba(255, 255, 0, 0.2);
      border: 1px solid rgba(255, 0, 0, 0.5);
      font-weight: bold;
      text-align: right;
    }

    /* KROK 3: PRECYZYJNE POZYCJONOWANIE
       Zmieniaj wartości 'top', 'left', 'width', aby dopasować pola do tła.
    */
    
    /* Dane z XML */
    #data-wystawienia  { top: 80px; left: 1000px; width: 120px; text-align: right;}
    #miejsce-wystawienia { top: 60px; left: 1100px; width: 110px; text-align: right;}
    #sprzedawca-nazwa  { top: 100px; left: 450px; width: 210px; }
    
    /* Dane wpisywane (Nabywca) */
    #nabywca-nazwa { top: 100px; left: 175px; width: 210px; }
    #nabywca-adres { top: 125px; left: 175px; width: 210px; }
    
    /* ---- WIERSZ 1 ---- */
    #nazwa-towaru-1 { top: 310px; left: 110px; width: 210px; }
    #ilosc-1        { top: 310px; left: 450px; width: 50px; text-align: right; }
    #cena-jedn-1    { top: 310px; left: 520px; width: 70px; text-align: right; }
    #wartosc-towaru-1 { top: 310px; left: 610px; width: 90px; }
    
    /* ---- WIERSZ 2 ---- */
    #nazwa-towaru-2 { top: 335px; left: 110px; width: 210px; }
    #ilosc-2        { top: 335px; left: 450px; width: 50px; text-align: right; }
    #cena-jedn-2    { top: 335px; left: 520px; width: 70px; text-align: right; }
    #wartosc-towaru-2 { top: 335px; left: 610px; width: 90px; }

    /* ---- RAZEM ---- */
    #suma-razem     { top: 670px; left: 610px; width: 90px; font-size: 15px; }

  </style>
</head>
<body>

  <div class="faktura-kontener">
    
    <span id="data-wystawienia" class="pole pole-xml"></span>
    <span id="miejsce-wystawienia" class="pole pole-xml"></span>
    <span id="sprzedawca-nazwa" class="pole pole-xml"></span>
    
    <input type="text" id="nabywca-nazwa" class="pole pole-input" placeholder="Imię, nazwisko...">
    <input type="text" id="nabywca-adres" class="pole pole-input" placeholder="Adres...">
    
    <input type="text" id="nazwa-towaru-1" class="pole pole-input" placeholder="Nazwa towaru...">
    <input type="number" id="ilosc-1" class="pole pole-input pole-obliczeniowe" value="0" min="0">
    <input type="number" id="cena-jedn-1" class="pole pole-input pole-obliczeniowe" value="0.00" step="0.01" min="0">
    <input type="text" id="wartosc-towaru-1" class="pole pole-wynik" readonly>
    
    <input type="text" id="nazwa-towaru-2" class="pole pole-input" placeholder="Nazwa towaru...">
    <input type="number" id="ilosc-2" class="pole pole-input pole-obliczeniowe" value="0" min="0">
    <input type="number" id="cena-jedn-2" class="pole pole-input pole-obliczeniowe" value="0.00" step="0.01" min="0">
    <input type="text" id="wartosc-towaru-2" class="pole pole-wynik" readonly>
    
    <input type="text" id="suma-razem" class="pole pole-wynik" readonly>

  </div>

  <script>
    
    // ==========================================================
    // CZĘŚĆ 1: ŁADOWANIE DANYCH STATYCZNYCH Z XML
    // ==========================================================
    async function zaladujDaneXML() {
      try {
        const response = await fetch('faktura.xml');
        if (!response.ok) {
            throw new Error(`Błąd HTTP! Status: ${response.status}`);
        }
        const xmlText = await response.text();
        
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlText, "application/xml");

        // Wyciągamy dane z XML
        const data = xmlDoc.querySelector('dataWystawienia').textContent;
        const miejsce = xmlDoc.querySelector('miejsceWystawienia').textContent;
        const sprzedawca = xmlDoc.querySelector('sprzedawca nazwa').textContent;

        // Wstrzykujemy dane do naszych pól HTML
        document.getElementById('data-wystawienia').textContent = data;
        document.getElementById('miejsce-wystawienia').textContent = miejsce;
        document.getElementById('sprzedawca-nazwa').textContent = sprzedawca;
        
      } catch (error) {
        console.error('Nie można załadować pliku XML:', error);
        alert('Nie udało się załadować danych statycznych z XML. Sprawdź, czy plik dane.xml istnieje i czy serwer działa.');
      }
    }

    // ==========================================================
    // CZĘŚĆ 2: KALKULATOR SUM (JavaScript)
    // ==========================================================
    function obliczSume() {
      let sumaCalkowita = 0;
      
      // --- Przetwarzanie Wiersza 1 ---
      const ilosc1 = parseFloat(document.getElementById('ilosc-1').value) || 0;
      const cena1 = parseFloat(document.getElementById('cena-jedn-1').value) || 0;
      const wartosc1 = ilosc1 * cena1;
      document.getElementById('wartosc-towaru-1').value = wartosc1.toFixed(2);
      sumaCalkowita += wartosc1;
      
      // --- Przetwarzanie Wiersza 2 ---
      const ilosc2 = parseFloat(document.getElementById('ilosc-2').value) || 0;
      const cena2 = parseFloat(document.getElementById('cena-jedn-2').value) || 0;
      const wartosc2 = ilosc2 * cena2;
      document.getElementById('wartosc-towaru-2').value = wartosc2.toFixed(2);
      sumaCalkowita += wartosc2;
      
      // --- Wyświetlenie sumy końcowej ---
      document.getElementById('suma-razem').value = sumaCalkowita.toFixed(2) + ' zł';
    }

    // ==========================================================
    // START PROGRAMU
    // ==========================================================

    // Kiedy strona się załaduje, najpierw wczytaj dane z XML
    document.addEventListener('DOMContentLoaded', zaladujDaneXML);

    // Znajdź wszystkie pola, które wpływają na obliczenia
    const polaDoKalkulacji = document.querySelectorAll('.pole-obliczeniowe');
    
    // Dodaj "nasłuch" do każdego z nich, aby przeliczać sumę na żywo
    polaDoKalkulacji.forEach(function(pole) {
      pole.addEventListener('input', obliczSume);
    });

    // Uruchom obliczenia raz na starcie, aby wyświetlić "0.00"
    obliczSume();

  </script>

</body>
</html>